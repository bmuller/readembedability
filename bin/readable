#!/usr/bin/env python
import sys, os

from twisted.internet import reactor
from twisted.python import log

sys.path.append("%s/.." % os.path.dirname(__file__))

from readembedability.page import getReadembedable

log.startLogging(sys.stdout)

def p(r):
    for k, v in r.iteritems():
        if type(v) is str or type(v) is unicode:
            v = v.replace("\n", " ")
        print "%s: %s\n" % (k, v)
    reactor.stop()

def f(r):
    print r
    reactor.stop()

if len(sys.argv) < 2:
    print "Usage: %s http://a/path" % sys.argv[0]
    sys.exit(0)

getReadembedable(sys.argv[1], debug=True).addCallbacks(p, f)
reactor.run()
